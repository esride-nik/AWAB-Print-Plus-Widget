{"version":3,"sources":["WebAppBuilder/subm_PrintPlus/PrintPlus/Widget.ts"],"names":[],"mappings":"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","file":"Widget.js","sourcesContent":["import declare = require('dojo/_base/declare');\r\nimport domConstruct = require('dojo/dom-construct');\r\nimport domStyle = require('dojo/dom-style');\r\nimport domGeometry = require('dojo/dom-geometry');\r\nimport lang = require('dojo/_base/lang');\r\nimport BaseWidget = require('jimu/BaseWidget');\r\nimport Print = require('./PrintPlus');\r\n\r\ninterface dojoMarginBox {\r\n  l: number\r\n  t: number\r\n  w: number\r\n  h: number\r\n}\r\n\r\nclass Widget extends BaseWidget {\r\n\r\n  baseClass = \"jimu-widget-printplus\";\r\n  private print: Print;\r\n  private config: any;\r\n  private printPlusNode: HTMLElement;\r\n\r\n  constructor(args?: Array<any>) {\r\n    super(lang.mixin({ baseClass: \"jimu-widget-printplus\" },\r\n     args));\r\n    console.log(`Constructor of ${this.baseClass}`);\r\n  }\r\n\r\n  postCreate() {\r\n    super.postCreate();\r\n    this.print = new Print({\r\n      map: this.map,\r\n      printTaskURL: this.config.serviceURL,\r\n      defaultAuthor: this.config.defaultAuthor,\r\n      defaultCopyright: this.config.defaultCopyright,\r\n      defaultTitle: this.config.defaultTitle,\r\n      defaultFormat: this.config.defaultFormat,\r\n      defaultLayout: this.config.defaultLayout,\r\n      defaultDpi: this.config.defaultDpi || 96,\r\n      noTitleBlockPrefix: this.config.noTitleBlockPrefix,\r\n      layoutParams: this.config.layoutParams,\r\n      relativeScale: this.config.relativeScale,\r\n      relativeScaleFactor: this.config.relativeScaleFactor,\r\n      scalePrecision: this.config.scalePrecision,\r\n      mapScales: this.config.mapScales,\r\n      outWkid: this.config.outWkid,\r\n      showLayout: this.config.showLayout,\r\n      showOpacitySlider: this.config.showOpacitySlider,\r\n      domIdPrefix: this.id,\r\n      nls: this.nls\r\n    }).placeAt(this.printPlusNode);\r\n    this.print.startup();\r\n  }\r\n\r\n  onSignIn(credential: any){\r\n    super.onSignIn(credential);\r\n    console.log(\"onSignIn\", credential);\r\n    user = user || {};\r\n    if (user.userId) {\r\n      this.print.updateAuthor(user.userId);\r\n    }\r\n  }\r\n\r\n  onOpen() {\r\n    super.onOpen();\r\n    this.print._onOpen();\r\n  }\r\n\r\n  onClose() {\r\n    super.onClose();\r\n    this.print._onClose();\r\n  }\r\n\r\n  resize() {\r\n    super.resize();\r\n    // If the widget docked, its panel will have the same width as the innerWidth of the browser window.\r\n    // Delay for a brief time to allow the panel to attain its full size.\r\n    setTimeout(() => {\r\n      var node = this.getParent().domNode;\r\n      var computedStyle = domStyle.getComputedStyle(node) as undefined;\r\n      var output = domGeometry.getMarginBox(node, computedStyle) as dojoMarginBox;\r\n      var isDocked = Math.abs(window.innerWidth - output.w) <= 1;\r\n\r\n      this.print._resize(isDocked);\r\n    }, 100);\r\n  }\r\n  \r\n  // startup() {\r\n  //   super.startup();\r\n  //   console.log(`Startup of ${this.baseClass}`);   \r\n  //   // Without this function, onOpen() is not called on startup - only resize(). \r\n  // }\r\n}\r\n\r\nexport = Widget;\r\n"]}